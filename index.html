<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>배너 합성 툴</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  #canvasWrapper { border: 1px solid #ddd; display: inline-block; margin-top: 20px; }
  button { margin: 5px; }
</style>
</head>
<body>

<h2>배너 합성 툴</h2>

<input type="file" id="uploadImage" accept="image/*"><br><br>

<button onclick="setFormat('biz2_1')">Biz 2:1</button>
<button onclick="setFormat('biz1_1')">Biz 1:1</button>
<button onclick="setFormat('mo2_1')">Mo 2:1</button>
<button onclick="download()">다운로드</button>
<button onclick="resetCanvas()">초기화</button>

<div id="canvasWrapper">
  <canvas id="bannerCanvas"></canvas>
</div>

<script>
const canvas = document.getElementById('bannerCanvas');
const ctx = canvas.getContext('2d');
let uploadedImage = null;

function setFormat(format) {
  const img = uploadedImage;
  if (!img) {
    alert('이미지를 먼저 업로드하세요.');
    return;
  }

  if (format === 'biz2_1') {
    canvas.width = 600;
    canvas.height = 300;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    const targetWidth = 600;
    const targetHeight = 300;
    
    const scale = Math.max(targetWidth / img.width, targetHeight / img.height);
    const newWidth = img.width * scale;
    const newHeight = img.height * scale;
    const offsetX = (targetWidth - newWidth) / 2;
    const offsetY = (targetHeight - newHeight) / 2;
    
    ctx.drawImage(img, offsetX, offsetY, newWidth, newHeight);

  } else if (format === 'biz1_1') {
    canvas.width = 315;
    canvas.height = 315;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const targetWidth = 315;
    const targetHeight = 315;

    const scale = Math.max(targetWidth / img.width, targetHeight / img.height);
    const newWidth = img.width * scale;
    const newHeight = img.height * scale;
    const offsetX = (targetWidth - newWidth) / 2;
    const offsetY = (targetHeight - newHeight) / 2;

    ctx.drawImage(img, offsetX, offsetY, newWidth, newHeight);

  } else if (format === 'mo2_1') {
    canvas.width = 1200;
    canvas.height = 600;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const visualWidth = 1200;
    const visualHeight = 497;
    const topMargin = 193;

    ctx.drawImage(img, 0, topMargin, visualWidth, visualHeight);
  }
}

document.getElementById('uploadImage').addEventListener('change', function(e) {
  const reader = new FileReader();
  reader.onload = function(event) {
    const img = new Image();
    img.onload = function() {
      uploadedImage = img;
      alert('이미지가 업로드되었습니다.');
    }
    img.src = event.target.result;
  }
  reader.readAsDataURL(e.target.files[0]);
});

function download() {
  const link = document.createElement('a');
  link.download = 'banner.png';
  link.href = canvas.toDataURL();
  link.click();
}

function resetCanvas() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  uploadedImage = null;
  canvas.width = 0;
  canvas.height = 0;
}
</script>

</body>
</html>
